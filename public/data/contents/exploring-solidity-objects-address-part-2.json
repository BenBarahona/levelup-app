{
  "id": "exploring-solidity-objects-address-part-2",
  "name": "Exploring Solidity Objects: Address - Part 2",
  "index": 2,
  "summary": "Dive into the world of Solidity in pursuit of leveling up! Venturing into delegatecall and staticcall functions!",
  "labels": [
    "Smart Contract"
  ],
  "content": {
    "compiledSource": "/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    a: \"a\",\n    code: \"code\",\n    strong: \"strong\",\n    h2: \"h2\",\n    em: \"em\"\n  }, _provideComponents(), props.components), {ContentCopy, YoutubeEmbed} = _components;\n  if (!ContentCopy) _missingMdxReference(\"ContentCopy\", true);\n  if (!YoutubeEmbed) _missingMdxReference(\"YoutubeEmbed\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h1, {\n      children: \"Exploring Solidity Objects: Address - Part 2\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In \", _jsx(_components.a, {\n        href: \"https://rhbdl.substack.com/p/exploring-solidity-objects-address?r=1v972g\",\n        children: \"Part 1\"\n      }), \", we explored different \", _jsx(_components.code, {\n        children: \"address\"\n      }), \" members and their use cases. While the previous article explored scenarios involving sending Ether, it is helpful to know that the functionalities extend beyond that.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For instance, the \", _jsx(_components.code, {\n        children: \"call\"\n      }), \" function is a low-level function which has the capability to invoke any function on any target contract by specifying the function signature and arguments in the \\\"data\\\" parameter. \", _jsx(_components.strong, {\n        children: \"(Security Note: call never reverts. It is our responsibility to handle unsuccessful transaction errors.)\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now, let's delve into the final two members of the address object: \", _jsx(_components.code, {\n        children: \"staticcall\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"delegatecall\"\n      }), \". These members are also interchangeably referred as functions - particularly when describing their role in code execution through invocation.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The underlying concept of \", _jsx(_components.code, {\n        children: \"staticcall\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"delegatecall\"\n      }), \" is relatively straightforward, as they are essentially specialized variants of the \", _jsx(_components.code, {\n        children: \"call\"\n      }), \" function.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: _jsx(_components.strong, {\n        children: \"1. delegatecall\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This function allows state modifying instructions while preserving the original contract's context (storage, sender address, and value).\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"At this point, you might be wondering about the terminology “delegatecall”. How exactly are the function calls “delegated”? Or rather, what is the mode of “delegation” here?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's utilise the code below to answer these questions!\"\n    }), \"\\n\", _jsx(ContentCopy, {\n      code: `pragma solidity ^0.8.24;\n\ncontract Caller {\n    uint256 public value;\n\n    function setVars(uint256 _value) public payable {\n        value = _value;\n    }\n}\n\ncontract DelegateCaller {\n    uint256 public value;\n\n    function setVars(address _callerContract, uint256 _value) public payable {\n        // Caller delegated its setVars() function to DelegateCaller Contract\n        (bool success, ) = _callerContract.delegatecall(\n            abi.encodeWithSignature(\"setVars(uint256)\", _value)\n        );\n        if (!success) revert(\"Failed\");\n    }\n}`,\n      language: \"solidity\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"When \", _jsx(_components.code, {\n        children: \"setVars()\"\n      }), \" is called in DelegateCaller contract, the \", _jsx(_components.code, {\n        children: \"delegatecall\"\n      }), \" invokes the \", _jsx(_components.code, {\n        children: \"setVars()\"\n      }), \" function in the Caller contract but in the DelegateCaller execution environment.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Thus, Caller contract has effectively delegated its function to DelegateCaller contract.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's explore further using the video below! (\", _jsxs(_components.strong, {\n        children: [\"Watch what happens when \", _jsx(_components.code, {\n          children: \"setVars()\"\n        }), \" was called in DelegateCaller contract.\"]\n      }), \" Observe how the \", _jsx(_components.code, {\n        children: \"value\"\n      }), \" variables change in the context of Caller and DelegateCaller contract.)\"]\n    }), \"\\n\", _jsx(YoutubeEmbed, {\n      id: \"IUhr8N_WroI\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsxs(_components.em, {\n        children: [\"Were you able to identify the contract that had its \", _jsx(_components.code, {\n          children: \"value\"\n        }), \" variable updated when \", _jsx(_components.code, {\n          children: \"delegatecall\"\n        }), \" was invoked?\"]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This behavior might seem redundant at first when we can simply use \", _jsx(_components.code, {\n        children: \"call\"\n      }), \" function. However, \", _jsx(_components.code, {\n        children: \"delegatecall\"\n      }), \" enables use cases such as for proxy contracts - where only the implementation contract (i.e. Uniswap V2, V3) is upgraded to preserve the context of the proxy contract.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Having explored the complexities of \", _jsx(_components.code, {\n        children: \"delegatecall\"\n      }), \", let’s proceed to explore \", _jsx(_components.code, {\n        children: \"staticcall\"\n      }), \" which is relatively simpler!\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: _jsx(_components.strong, {\n        children: \"2. staticcall\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In general, \", _jsx(_components.code, {\n        children: \"staticcall\"\n      }), \" does not allow any state modifying instructions or capability to send ether. It will revert if there are any state changes during the function invocation.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"At a low-level, it disallows opcodes such as CREATE, SSTORE, SELFDESTRUCT, and few \", _jsx(_components.a, {\n        href: \"https://www.evm.codes/#fa?fork=cancun\",\n        children: \"others\"\n      }), \". Personally, I view \", _jsx(_components.code, {\n        children: \"staticcall\"\n      }), \" as a safer variant of the call function to read state.\"]\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"text-center \",\n      children: [_jsx(\"img\", {\n        src: \"/images/contents/staticcall.png\",\n        alt: \"staticcall example\",\n        width: \"750\"\n      }), _jsx(_components.p, {\n        children: _jsxs(_components.em, {\n          children: [\"Figure 1: \", _jsx(_components.code, {\n            children: \"staticcall\"\n          }), \" example\"]\n        })\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In the example above, notice how the \", _jsx(_components.code, {\n        children: \"value\"\n      }), \" variable for StaticCaller contract did not change. It remains as “0” even when Caller contract has been updated to store “100” in its \", _jsx(_components.code, {\n        children: \"value\"\n      }), \" variable. Unlike \", _jsx(_components.code, {\n        children: \"delegatecall\"\n      }), \" which allows state modifying instruction, \", _jsx(_components.code, {\n        children: \"staticcall\"\n      }), \" only reads state of the target contract (Caller contract in this example).\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"As a treat, I have also included a function \", _jsx(_components.code, {\n        children: \"setVars()\"\n      }), \" which purposefully calls a state modifying function from the target contract to simulate transaction failure. Watch the video towards the end to learn what happens when \", _jsx(_components.code, {\n        children: \"success\"\n      }), \" returns false.\"]\n    }), \"\\n\", _jsx(YoutubeEmbed, {\n      id: \"iGQ5z6B1PQw\"\n    }), \"\\n\", _jsx(\"div\", {\n      className: \"text-center\",\n      children: _jsx(_components.p, {\n        children: _jsxs(_components.em, {\n          children: [\"Explore this code further here: \", _jsx(_components.a, {\n            href: \"https://remix.ethereum.org/?#code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVApwcmFnbWEgc29saWRpdHkgXjAuOC4yNDsKCmNvbnRyYWN0IENhbGxlciB7CiAgICB1aW50MjU2IHB1YmxpYyB2YWx1ZTsKCiAgICBmdW5jdGlvbiBzZXRWYXJzKHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgdmFsdWUgPSBfdmFsdWU7CiAgICB9CgogICAgZnVuY3Rpb24gcmVhZFZhbHVlKCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludDI1NikgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KfQoKY29udHJhY3QgU3RhdGljQ2FsbGVyIHsKICAgIHVpbnQyNTYgcHVibGljIHZhbHVlOwoKICAgIGZ1bmN0aW9uIHNldFZhcnMoYWRkcmVzcyBfY2FsbGVyQ29udHJhY3QsIHVpbnQyNTYgX3ZhbHVlKSBwdWJsaWMgcGF5YWJsZSB7CiAgICAgICAgKGJvb2wgc3VjY2VzcywgKSA9IF9jYWxsZXJDb250cmFjdC5zdGF0aWNjYWxsKAogICAgICAgICAgICBhYmkuZW5jb2RlV2l0aFNpZ25hdHVyZSgic2V0VmFycyh1aW50MjU2KSIsIF92YWx1ZSkKICAgICAgICApOwogICAgICAgIGlmKCFzdWNjZXNzKSByZXZlcnQgKCJFcnJvciBpbiBzdGF0aWNjYWxsIik7CiAgICB9CgogICAgZnVuY3Rpb24gcmVhZFZhcnMoYWRkcmVzcyBfY2FsbGVyQ29udHJhY3QpIHB1YmxpYyB2aWV3IHJldHVybnMgKHVpbnQyNTYpIHsKICAgICAgICAoLCBieXRlcyBtZW1vcnkgZGF0YSkgPSBfY2FsbGVyQ29udHJhY3Quc3RhdGljY2FsbChhYmkuZW5jb2RlV2l0aFNpZ25hdHVyZSgicmVhZFZhbHVlKCkiKSk7CiAgICAgICAgcmV0dXJuIGFiaS5kZWNvZGUoZGF0YSwgKHVpbnQyNTYpKTsKICAgIH0KfQ&lang=en&optimize=false&runs=200&evmVersion=null&version=soljson-v0.8.26+commit.8a97fa7a.js\",\n            children: \"staticcall.sol\"\n          })]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In \", _jsx(_components.a, {\n        href: \"https://ethglobal.com/events/brussels/prizes/scroll\",\n        children: \"ETH CC Brussels\"\n      }), \", Scroll introduced the experimental \", _jsx(_components.a, {\n        href: \"https://ethereum-magicians.org/t/rip-7728-l1sload-precompile/20388\",\n        children: \"L1SLOAD precompile\"\n      }), \" which uses \", _jsx(_components.code, {\n        children: \"staticcall\"\n      }), \" under the hood.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Hackers were able to explore novel methods of resolving ENS address, extending NFT ownership - all on L2. Despite preliminary stage of experimentation, this highlights that the potential opportunities for this function are virtually limitless.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now that you have equipped yourself with an arsenal of knowledge on the \", _jsx(_components.code, {\n        children: \"address\"\n      }), \" object, you are now capable of address-ing (Hehe! Pun intended) more intermediate to advanced level builds. Can't wait to hear all about how you will be using this knowledge to level up your projects.\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n",
    "frontmatter": {},
    "scope": {}
  }
}